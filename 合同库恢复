原库：
暂停应用服务。fjctcms
暂停监听服务
导出
迁移后更改数据库链接配置i
迁移库：
装GRID/DATABASE
创建表空间/用户/创建dblink
导入
检查数据完整性，测试链接

数据库数据恢复

/*一、创建表空间*/

/*
DROP TABLESPACE FJCTCMS_DATA INCLUDING CONTENTS AND DATAFILES;
DROP TABLESPACE FJCTCMS_TEST1_DATA INCLUDING CONTENTS AND DATAFILES;
DROP TABLESPACE FJCTCMS_GWJT_DATA INCLUDING CONTENTS AND DATAFILES;
DROP TABLESPACE FJCTCMS_WZSY_DATA INCLUDING CONTENTS AND DATAFILES;
DROP TABLESPACE FJCTCMS_YYJT_DATA INCLUDING CONTENTS AND DATAFILES;
DROP TABLESPACE FJCTCMS_DNSY_DATA INCLUDING CONTENTS AND DATAFILES;
DROP TABLESPACE FJCTCMS_GLMT_DATA INCLUDING CONTENTS AND DATAFILES;
DROP TABLESPACE FJCTCMS_BFCB_DATA INCLUDING CONTENTS AND DATAFILES;
DROP TABLESPACE FJCTCMS_PTGW_DATA INCLUDING CONTENTS AND DATAFILES;
DROP TABLESPACE FJCTCMS_LYGK_DATA INCLUDING CONTENTS AND DATAFILES;
DROP TABLESPACE FJCTCMS_TEST_DATA INCLUDING CONTENTS AND DATAFILES;*/


/*1、FJCTCMS_DATA*/
CREATE TABLESPACE FJCTCMS_DATA DATAFILE 
  '/oradata/frdb/DATAFILE/fjctcms_data.dbf' SIZE 2G AUtoEXTEND ON NEXT 10M MAXSIZE 4G
LOGGING
ONLINE
EXTENT MANAGEMENT LOCAL AUtoALLOCATE
BLOCKSIZE 8K
SEGMENT SPACE MANAGEMENT AUto
FLASHBACK ON;

/*2、FJCTCMS_TEST1_DATA*/
CREATE TABLESPACE FJCTCMS_TEST1_DATA DATAFILE 
  '/oradata/frdb/DATAFILE/fjctcms_test1_data.dbf' SIZE 2G AUtoEXTEND ON NEXT 10M MAXSIZE 4G
LOGGING
ONLINE
EXTENT MANAGEMENT LOCAL AUtoALLOCATE
BLOCKSIZE 8K
SEGMENT SPACE MANAGEMENT AUto
FLASHBACK ON;

/*3、FJCTCMS_GWJT_DATA*/
CREATE TABLESPACE FJCTCMS_GWJT_DATA DATAFILE 
  '/oradata/frdb/DATAFILE/fjctcms_gwjt_data.dbf' SIZE 2G AUtoEXTEND ON NEXT 10M MAXSIZE 4G
LOGGING
ONLINE
EXTENT MANAGEMENT LOCAL AUtoALLOCATE
BLOCKSIZE 8K
SEGMENT SPACE MANAGEMENT AUto
FLASHBACK ON;

/*4、FJCTCMS_WZSY_DATA*/
CREATE TABLESPACE FJCTCMS_WZSY_DATA DATAFILE 
  '/oradata/frdb/DATAFILE/fjctcms_wzsy_data.dbf' SIZE 2G AUtoEXTEND ON NEXT 10M MAXSIZE 4G
LOGGING
ONLINE
EXTENT MANAGEMENT LOCAL AUtoALLOCATE
BLOCKSIZE 8K
SEGMENT SPACE MANAGEMENT AUto
FLASHBACK ON;

/*5、FJCTCMS_YYJT_DATA*/
CREATE TABLESPACE FJCTCMS_YYJT_DATA DATAFILE 
  '/oradata/frdb/DATAFILE/fjctcms_yyjt_data.dbf' SIZE 2G AUtoEXTEND ON NEXT 10M MAXSIZE 4G
LOGGING
ONLINE
EXTENT MANAGEMENT LOCAL AUtoALLOCATE
BLOCKSIZE 8K
SEGMENT SPACE MANAGEMENT AUto
FLASHBACK ON;

/*6、FJCTCMS_DNSY_DATA*/
CREATE TABLESPACE FJCTCMS_DNSY_DATA DATAFILE 
  '/oradata/frdb/DATAFILE/fjctcms_dnsy_data.dbf' SIZE 2G AUtoEXTEND ON NEXT 10M MAXSIZE 4G
LOGGING
ONLINE
EXTENT MANAGEMENT LOCAL AUtoALLOCATE
BLOCKSIZE 8K
SEGMENT SPACE MANAGEMENT AUto
FLASHBACK ON;

/*7、FJCTCMS_GLMT_DATA*/
CREATE TABLESPACE FJCTCMS_GLMT_DATA DATAFILE 
  '/oradata/frdb/DATAFILE/fjctcms_glmt_data.dbf' SIZE 2G AUtoEXTEND ON NEXT 10M MAXSIZE 4G
LOGGING
ONLINE
EXTENT MANAGEMENT LOCAL AUtoALLOCATE
BLOCKSIZE 8K
SEGMENT SPACE MANAGEMENT AUto
FLASHBACK ON;

/*8、FJCTCMS_BFCB_DATA*/
CREATE TABLESPACE FJCTCMS_BFCB_DATA DATAFILE 
  '/oradata/frdb/DATAFILE/fjctcms_data_bfcb.dbf' SIZE 2G AUtoEXTEND ON NEXT 10M MAXSIZE 4G
LOGGING
ONLINE
EXTENT MANAGEMENT LOCAL AUtoALLOCATE
BLOCKSIZE 8K
SEGMENT SPACE MANAGEMENT AUto
FLASHBACK ON;

/*9、FJCTCMS_PTGW_DATA*/
CREATE TABLESPACE FJCTCMS_PTGW_DATA DATAFILE 
  '/oradata/frdb/DATAFILE/fjctcms_ptgw_data.dbf' SIZE 2G AUtoEXTEND ON NEXT 10M MAXSIZE 4G
LOGGING
ONLINE
EXTENT MANAGEMENT LOCAL AUtoALLOCATE
BLOCKSIZE 8K
SEGMENT SPACE MANAGEMENT AUto
FLASHBACK ON;

/*10、FJCTCMS_LYGK_DATA*/
CREATE TABLESPACE FJCTCMS_LYGK_DATA DATAFILE 
  '/oradata/frdb/DATAFILE/fjctcms_lygk_data.dbf' SIZE 2G AUtoEXTEND ON NEXT 10M MAXSIZE 4G
LOGGING
ONLINE
EXTENT MANAGEMENT LOCAL AUtoALLOCATE
BLOCKSIZE 8K
SEGMENT SPACE MANAGEMENT AUto
FLASHBACK ON;

/*11、FJCTCMS_TEST_DATA*/
CREATE TABLESPACE FJCTCMS_TEST_DATA DATAFILE 
  '/oradata/frdb/DATAFILE/fjctcms_test_data.dbf' SIZE 2G AUtoEXTEND ON NEXT 10M MAXSIZE 4G
LOGGING
ONLINE
EXTENT MANAGEMENT LOCAL AUtoALLOCATE
BLOCKSIZE 8K
SEGMENT SPACE MANAGEMENT AUto
FLASHBACK ON;

/*二、创建导入文件夹*/

create or replace directory dmp  as '/orabak/dump';

/*三、创建用户并赋权*/
/*
DROP USER FJCTCMS CASCADE; 
DROP USER FJCTCMS_BFCB CASCADE; 
DROP USER FJCTCMS_DNSY CASCADE;
DROP USER FJCTCMS_GLMT CASCADE; 
DROP USER FJCTCMS_GWJT CASCADE; 
DROP USER FJCTCMS_LYGK CASCADE; 
DROP USER FJCTCMS_PTGW CASCADE; 
DROP USER FJCTCMS_TEST CASCADE;  
DROP USER FJCTCMS_TEST1 CASCADE;
DROP USER FJCTCMS_WZSY CASCADE; 
DROP USER FJCTCMS_YYJT CASCADE; */

/*FJCTCMS*/
CREATE USER FJCTCMS IDENTIFIED BY fjctcms DEFAULT TABLESPACE FJCTCMS_DATA ACCOUNT UNLOCK;
GRANT CONNECT,RESOURCE TO FJCTCMS;
GRANT UNLIMITED TABLESPACE TO FJCTCMS;
GRANT exp_full_DATAbase to FJCTCMS;
GRANT imp_full_DATAbase to FJCTCMS;
GRANT READ,WRITE ON DIRECTORY DMP TO FJCTCMS;

/*FJCTCMS_BFCB*/
CREATE USER FJCTCMS_BFCB IDENTIFIED BY fjctcms DEFAULT TABLESPACE FJCTCMS_BFCB_DATA ACCOUNT UNLOCK;
GRANT CONNECT,RESOURCE TO FJCTCMS_BFCB;
GRANT UNLIMITED TABLESPACE TO FJCTCMS_BFCB;
GRANT exp_full_DATAbase to FJCTCMS_BFCB;
GRANT imp_full_DATAbase to FJCTCMS_BFCB;
GRANT READ,WRITE ON DIRECTORY DMP TO FJCTCMS_BFCB;

/*FJCTCMS_DNSY*/
CREATE USER FJCTCMS_DNSY IDENTIFIED BY fjctcms DEFAULT TABLESPACE FJCTCMS_DNSY_DATA ACCOUNT UNLOCK;
GRANT CONNECT,RESOURCE TO FJCTCMS_DNSY;
GRANT UNLIMITED TABLESPACE TO FJCTCMS_DNSY;
GRANT exp_full_DATAbase to FJCTCMS_DNSY;
GRANT imp_full_DATAbase to FJCTCMS_DNSY;
GRANT READ,WRITE ON DIRECTORY DMP TO FJCTCMS_DNSY;

/*FJCTCMS_GLMT*/
CREATE USER FJCTCMS_GLMT IDENTIFIED BY fjctcms DEFAULT TABLESPACE FJCTCMS_GLMT_DATA ACCOUNT UNLOCK;
GRANT CONNECT,RESOURCE TO FJCTCMS_GLMT;
GRANT UNLIMITED TABLESPACE TO FJCTCMS_GLMT;
GRANT exp_full_DATAbase to FJCTCMS_GLMT;
GRANT imp_full_DATAbase to FJCTCMS_GLMT;
GRANT READ,WRITE ON DIRECTORY DMP TO FJCTCMS_GLMT;

/*FJCTCMS_GWJT*/
CREATE USER FJCTCMS_GWJT IDENTIFIED BY fjctcms DEFAULT TABLESPACE FJCTCMS_GWJT_DATA ACCOUNT UNLOCK;
GRANT CONNECT,RESOURCE TO FJCTCMS_GWJT;
GRANT UNLIMITED TABLESPACE TO FJCTCMS_GWJT;
GRANT exp_full_DATAbase to FJCTCMS_GWJT;
GRANT imp_full_DATAbase to FJCTCMS_GWJT;
GRANT READ,WRITE ON DIRECTORY DMP TO FJCTCMS_GWJT;

/*FJCTCMS_LYGK*/
CREATE USER FJCTCMS_LYGK IDENTIFIED BY fjctcms DEFAULT TABLESPACE FJCTCMS_LYGK_DATA ACCOUNT UNLOCK;
GRANT CONNECT,RESOURCE TO FJCTCMS_LYGK;
GRANT UNLIMITED TABLESPACE TO FJCTCMS_LYGK;
GRANT exp_full_DATAbase to FJCTCMS_LYGK;
GRANT imp_full_DATAbase to FJCTCMS_LYGK;
GRANT READ,WRITE ON DIRECTORY DMP TO FJCTCMS_LYGK;

/*FJCTCMS_PTGW*/
CREATE USER FJCTCMS_PTGW IDENTIFIED BY fjctcms DEFAULT TABLESPACE FJCTCMS_PTGW_DATA ACCOUNT UNLOCK;
GRANT CONNECT,RESOURCE TO FJCTCMS_PTGW;
GRANT UNLIMITED TABLESPACE TO FJCTCMS_PTGW;
GRANT exp_full_DATAbase to FJCTCMS_PTGW;
GRANT imp_full_DATAbase to FJCTCMS_PTGW;
GRANT READ,WRITE ON DIRECTORY DMP TO FJCTCMS_PTGW;

/*FJCTCMS_TEST*/
CREATE USER FJCTCMS_TEST IDENTIFIED BY fjctcms DEFAULT TABLESPACE FJCTCMS_TEST_DATA ACCOUNT UNLOCK;
GRANT CONNECT,RESOURCE TO FJCTCMS_TEST;
GRANT UNLIMITED TABLESPACE TO FJCTCMS_TEST;
GRANT exp_full_DATAbase to FJCTCMS_TEST;
GRANT imp_full_DATAbase to FJCTCMS_TEST;
GRANT READ,WRITE ON DIRECTORY DMP TO FJCTCMS_TEST;

/*FJCTCMS_TEST1*/
CREATE USER FJCTCMS_TEST1 IDENTIFIED BY fjctcms DEFAULT TABLESPACE FJCTCMS_TEST1_DATA ACCOUNT UNLOCK;
GRANT CONNECT,RESOURCE TO FJCTCMS_TEST1;
GRANT UNLIMITED TABLESPACE TO FJCTCMS_TEST1;
GRANT exp_full_DATAbase to FJCTCMS_TEST1;
GRANT imp_full_DATAbase to FJCTCMS_TEST1;
GRANT READ,WRITE ON DIRECTORY DMP TO FJCTCMS_TEST1;

/*FJCTCMS_WZSY*/
CREATE USER FJCTCMS_WZSY IDENTIFIED BY fjctcms DEFAULT TABLESPACE FJCTCMS_WZSY_DATA ACCOUNT UNLOCK;
GRANT CONNECT,RESOURCE TO FJCTCMS_WZSY;
GRANT UNLIMITED TABLESPACE TO FJCTCMS_WZSY;
GRANT exp_full_DATAbase to FJCTCMS_WZSY;
GRANT imp_full_DATAbase to FJCTCMS_WZSY;
GRANT READ,WRITE ON DIRECTORY DMP TO FJCTCMS_WZSY;

/*FJCTCMS_YYJT*/
CREATE USER FJCTCMS_YYJT IDENTIFIED BY fjctcms DEFAULT TABLESPACE FJCTCMS_YYJT_DATA ACCOUNT UNLOCK;
GRANT CONNECT,RESOURCE TO FJCTCMS_YYJT;
GRANT UNLIMITED TABLESPACE TO FJCTCMS_YYJT;
GRANT exp_full_DATAbase to FJCTCMS_YYJT;
GRANT imp_full_DATAbase to FJCTCMS_YYJT;
GRANT READ,WRITE ON DIRECTORY DMP TO FJCTCMS_YYJT;

/*四、EXPDP/IMPDP（注意大小写）
原库操作
导出文件：dir  F\DMP\
for i in FJCTMS FJCTMS_BFCB FJCTMS_DNSY FJCTMS_GLMT FJCTMS_GWJT FJCTMS_LYGK FJCTMS_PTGW FJCTMS_TEST FJCTMS_TEST1 FJCTMS_WZSY FJCTMS_YYJT*/

expdp FJCTCMS/fjctcms schemas=FJCTCMS dumpfile=fjctms0118.dmp DIRECTORY=dir logfile=expFJCTMS0118.log
expdp FJCTCMS_BFCB/fjctcms schemas=FJCTCMS_BFCB dumpfile=bfcb0118.dmp DIRECTORY=dir logfile=expBFCB0118.log
expdp FJCTCMS_DNSY/fjctcms schemas=FJCTCMS_DNSY dumpfile=dnsy0118.dmp DIRECTORY=dir logfile=expDNSY0118.log
expdp FJCTCMS_GLMT/fjctcms schemas=FJCTCMS_GLMT dumpfile=glmt0118.dmp DIRECTORY=dir logfile=expGLMT0118.log
expdp FJCTCMS_GWJT/fjctcms schemas=FJCTCMS_GWJT dumpfile=gwjt0118.dmp DIRECTORY=dir logfile=expGWJT0118.log
expdp FJCTCMS_LYGK/fjctcms schemas=FJCTCMS_LYGK dumpfile=lygk0118.dmp DIRECTORY=dir logfile=expLYGK0118.log
expdp FJCTCMS_PTGW/fjctcms schemas=FJCTCMS_PTGW dumpfile=ptgw0118.dmp DIRECTORY=dir logfile=expPTGW0118.log
expdp FJCTCMS_TEST/fjctcms schemas=FJCTCMS_TEST dumpfile=test0118.dmp DIRECTORY=dir logfile=expTEST0118.log
expdp FJCTCMS_TEST1/fjctcms schemas=FJCTCMS_TEST1 dumpfile=test10118.dmp DIRECTORY=dir logfile=expTEST10118.log
expdp FJCTCMS_WZSY/fjctcms schemas=FJCTCMS_WZSY dumpfile=wzsy0118.dmp DIRECTORY=dir logfile=expWZSY0118.log
expdp FJCTCMS_YYJT/fjctcms schemas=FJCTCMS_YYJT dumpfile=yyjt0118.dmp DIRECTORY=dir logfile=expYYJT0118.log


/*迁移库
impdp user/password directory=dmp dumpfile=/*/**.dmp schemas=username REMAP_TABLESPACE=FJCTMS_DATA:FJCTMS_TEST1_DATA*/

impdp FJCTCMS/fjctcms schemas=FJCTCMS dumpfile=fjctms0118.dmp DIRECTORY=dmp REMAP_TABLESPACE=FJCTCMS_DATA:FJCTCMS_DATA  logfile=impFJCTMS0118.log
impdp FJCTCMS_BFCB/fjctcms schemas=FJCTCMS_BFCB dumpfile=bfcb0118.dmp DIRECTORY=dmp REMAP_TABLESPACE=FJCTCMS_DATA:FJCTCMS_BFCB_DATA  logfile=impBFCB0118.log
impdp FJCTCMS_DNSY/fjctcms schemas=FJCTCMS_DNSY dumpfile=dnsy0118.dmp DIRECTORY=dmp REMAP_TABLESPACE=FJCTCMS_DATA:FJCTCMS_DNSY_DATA  logfile=impDNSY0118.log
impdp FJCTCMS_GLMT/fjctcms schemas=FJCTCMS_GLMT dumpfile=glmt0118.dmp DIRECTORY=dmp REMAP_TABLESPACE=FJCTCMS_DATA:FJCTCMS_GLMT_DATA  logfile=impGLMT0118.log
impdp FJCTCMS_GWJT/fjctcms schemas=FJCTCMS_GWJT dumpfile=gwjt0118.dmp DIRECTORY=dmp REMAP_TABLESPACE=FJCTCMS_DATA:FJCTCMS_GWJT_DATA  logfile=impGWJT0118.log
impdp FJCTCMS_LYGK/fjctcms schemas=FJCTCMS_LYGK dumpfile=lygk0118.dmp DIRECTORY=dmp REMAP_TABLESPACE=FJCTCMS_DATA:FJCTCMS_LYGK_DATA  logfile=impLYGK0118.log
impdp FJCTCMS_PTGW/fjctcms schemas=FJCTCMS_PTGW dumpfile=ptgw0118.dmp DIRECTORY=dmp REMAP_TABLESPACE=FJCTCMS_DATA:FJCTCMS_PTGW_DATA  logfile=impPTGW0118.log
impdp FJCTCMS_TEST/fjctcms schemas=FJCTCMS_TEST dumpfile=test0118.dmp DIRECTORY=dmp REMAP_TABLESPACE=FJCTCMS_DATA:FJCTCMS_TEST_DATA  logfile=impTEST0118.log
impdp FJCTCMS_TEST1/fjctcms schemas=FJCTCMS_TEST1 dumpfile=test10118.dmp DIRECTORY=dmp REMAP_TABLESPACE=FJCTCMS_DATA:FJCTCMS_TEST1_DATA  logfile=impTEST10118.log
impdp FJCTCMS_WZSY/fjctcms schemas=FJCTCMS_WZSY dumpfile=wzsy0118.dmp DIRECTORY=dmp REMAP_TABLESPACE=FJCTCMS_DATA:FJCTCMS_WZSY_DATA  logfile=impWZSY0118.log
impdp FJCTCMS_YYJT/fjctcms schemas=FJCTCMS_YYJT dumpfile=yyjt0118.dmp DIRECTORY=dmp REMAP_TABLESPACE=FJCTCMS_DATA:FJCTCMS_YYJT_DATA  logfile=impYYJT0118.log


/*建立dblink：*/

CREATE PUBLIC DATABASE LINK BFCB
 CONNECT TO BFCBOA9
 IDENTIFIED BY "Fastriseoa)@!Bfcboa919"
 USING '(DESCRIPTION =
 (ADDRESS_LIST =
 (ADDRESS = (PROTOCOL = TCP)(HOST = 172.16.0.27)(PORT = 1521))
 )
 (CONNECT_DATA =
 (SERVICE_NAME =orcl)
 )
 )';
 
CREATE PUBLIC DATABASE LINK DNSY
 CONNECT TO DNSYOA
 IDENTIFIED BY "Fastriseoa)@^Dnsyoa19"
 USING '(DESCRIPTION =
 (ADDRESS_LIST =
 (ADDRESS = (PROTOCOL = TCP)(HOST = 172.16.0.26)(PORT = 1521))
 )
 (CONNECT_DATA =
 (SERVICE_NAME =orcl)
 )
 )';
 
CREATE PUBLIC DATABASE LINK GLMT
 CONNECT TO GLMTOA
 IDENTIFIED BY "Fastriseoa)@!Glmtoa19"
 USING '(DESCRIPTION =
 (ADDRESS_LIST =
 (ADDRESS = (PROTOCOL = TCP)(HOST = 172.16.0.27)(PORT = 1521))
 )
 (CONNECT_DATA =
 (SERVICE_NAME =orcl)
 )
 )';


CREATE PUBLIC DATABASE LINK GWJT
 CONNECT TO GWOA
 IDENTIFIED BY "Fastriseoa@!@Gwoa19"
 USING '(DESCRIPTION =
 (ADDRESS_LIST =
 (ADDRESS = (PROTOCOL = TCP)(HOST = 172.16.0.232)(PORT = 1521))
 )
 (CONNECT_DATA =
 (SERVICE_NAME =orcl)
 )
 )';
 
CREATE PUBLIC DATABASE LINK LYGK
 CONNECT TO LYMTOA
 IDENTIFIED BY "Fastriseoa)@^Lymtoa19"
 USING '(DESCRIPTION =
 (ADDRESS_LIST =
 (ADDRESS = (PROTOCOL = TCP)(HOST = 172.16.0.26)(PORT = 1521))
 )
 (CONNECT_DATA =
 (SERVICE_NAME =orcl)
 )
 )';
 
CREATE PUBLIC DATABASE LINK PTGW
 CONNECT TO PTGWOA
 IDENTIFIED BY "Fastriseoa)@!Ptgwoa19"
 USING '(DESCRIPTION =
 (ADDRESS_LIST =
 (ADDRESS = (PROTOCOL = TCP)(HOST = 172.16.0.27)(PORT = 1521))
 )
 (CONNECT_DATA =
 (SERVICE_NAME =orcl)
 )
 )';
 
CREATE PUBLIC DATABASE LINK YYJT
 CONNECT TO YYOA
 IDENTIFIED BY "Fastriseoa)@!Yyoa19"
 USING '(DESCRIPTION =
 (ADDRESS_LIST =
 (ADDRESS = (PROTOCOL = TCP)(HOST = 172.16.0.27)(PORT = 1521))
 )
 (CONNECT_DATA =
 (SERVICE_NAME =orcl)
 )
 )';
 
CREATE PUBLIC DATABASE LINK ZZGW
 CONNECT TO ZZGWOA
 IDENTIFIED BY "Fastriseoa)@!Zzgwoa19"
 USING '(DESCRIPTION =
 (ADDRESS_LIST =
 (ADDRESS = (PROTOCOL = TCP)(HOST = 172.16.0.27)(PORT = 1521))
 )
 (CONNECT_DATA =
 (SERVICE_NAME =orcl)
 )
 )';

